var e=$("#calendar");e.fullCalendar({header:{left:" today,prev,next,  title",right:"month,agendaWeek,agendaDay "},weekends:!0,allDaySlot:!0,droppable:!0,eventAfterAllRender:function(a){var t=e.find(".fc-header");t.find(".fc-header-right").find(".fc-button").off("mouseup").on("mouseup",function(){$(this).hasClass("fc-button-agendaView")||e.data("view","")}),e.data("view")!="agendaView"?(t.find(".fc-button-agendaView").removeClass("fc-state-active active"),$("#agendaView").remove()):g()},eventRender:function(a,t){currentView=$("#calendar").fullCalendar("getView").name},dayClick:function(a,t,n){},eventClick:function(a,t,n){console.log("===== eventClick ====="),console.log(a)}});var s=e.find(".fc-header").find(".fc-header-right"),v=s.find(".fc-corner-right").removeClass("fc-corner-right").clone().addClass("fc-corner-right fc-button-agendaView").removeClass("fc-button-agendaDay").text("agenda");v.on("click",function(){g()});s.find(".fc-header-space").before(v);var i=new Date,l=i.getDate(),f=i.getMonth(),o=i.getFullYear(),m={title:"NEW EVENT",start:new Date(o,f,l,10),end:new Date(o,f,l,15),editable:!0};$("#calendar").fullCalendar("renderEvent",m,"stick");function g(){if(e.fullCalendar("getView")!="agendaView"){e.fullCalendar("changeView","month");var a=e.fullCalendar("getView");a.name="agendaView",e.fullCalendar("changeView","agendaView")}var t=e.fullCalendar("clientEvents"),n=e.fullCalendar("getDate");e.find(".fc-header").find(".fc-button-agendaView").siblings().removeClass("fc-state-active").end().addClass("fc-state-active"),e.data("view","agendaView");var d=document.createElement("div");d.setAttribute("id","agendaView");var r="<table><thead><tr><th class='fc-widget-header fc-agendaView-event-start'>DateStart</th><th class='fc-widget-header fc-agendaView-event-end'>DateEnd</th><th class='fc-widget-header fc-agendaView-event-title'>Event</th></tr></thead><tbody>";for(key in t){var c=moment().range(moment(n).startOf("month"),moment(n).endOf("month")),w=moment(t[key].start).format("YYYY/MM/DD-H:mm:ss"),h=moment(t[key].end).format("YYYY/MM/DD-H:mm:ss");if(c.contains(t[key].start)&&c.contains(t[key].end)){var u=t[key].title;r+='<tr><td class="fc-widget-content">'+w+'</td><td class="fc-widget-content">'+h+'</td><td class="fc-widget-content">'+u+"</td></tr>"}}r+="</tbody></table>",d.innerHTML=r,e.find(".fc-content").html(d)}
